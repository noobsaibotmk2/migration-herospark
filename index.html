<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Migração de Produtos</title>

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #f2f2f2;
}

.container {
    background: #fff;
    max-width: 1400px;
    margin: 20px auto;
    padding: 20px;
}

h1 {
    font-size: 20px;
    margin-bottom: 10px;
}

.alert-red {
    color: red;
    font-size: 13px;
    margin-bottom: 10px;
}

.alert-yellow {
    background: #ffcc00;
    padding: 10px;
    font-size: 13px;
    margin-bottom: 20px;
}

input, select {
    width: 100%;
    padding: 6px;
    border: 1px solid #ccc;
    font-size: 12px;
}

button {
    background: #ffcc00;
    border: none;
    padding: 10px 25px;
    font-weight: bold;
    cursor: pointer;
}

table {
    width: 100%;
    border-collapse: collapse;
    font-size: 13px;
}

th {
    background: #d9d9d9;
    border: 1px solid #ccc;
    padding: 8px;
}

td {
    border: 1px solid #e0e0e0;
    padding: 5px;
}

.actions {
    margin-top: 15px;
    text-align: right;
}

.hidden {
    display: none;
}
</style>
</head>

<body>

<!-- ================= ADMIN ================= -->
<div class="container" id="admin">
<h1>Gerar Checklist</h1>

<input id="responsavel" placeholder="Responsável">
<br><br>
<input id="cliente" placeholder="Cliente">
<br><br>

<button onclick="criarChecklist()">Criar Checklist</button>
</div>

<!-- ================= CLIENTE ================= -->
<div class="container hidden" id="clienteView">

<h1>MIGRAÇÃO DE PRODUTOS</h1>

<div class="alert-red">
Preencha todos os dados corretamente para avançarmos com a migração.
</div>

<div class="alert-yellow">
Envie o acesso administrador da plataforma externa para <b>migrar@herospark.com</b>
</div>

<table>
<thead>
<tr>
<th>Tipo de Produto</th>
<th>Nome do Produto</th>
<th>Segmento</th>
<th>Link Oferta Unitária</th>
<th>Link Assinatura</th>
<th>Drive Conteúdos</th>
<th>Observações</th>
</tr>
</thead>
<tbody id="checklistTable">
<tr>
<td>
<select class="tipo">
<option></option>
<option>Curso</option>
<option>Mentoria</option>
<option>Assinatura</option>
</select>
</td>
<td><input class="nome"></td>
<td>
<select class="segmento">
<option></option>
<option>Educação</option>
<option>Marketing</option>
<option>Saúde</option>
</select>
</td>
<td><input class="oferta"></td>
<td><input class="assinatura"></td>
<td><input class="drive"></td>
<td><input class="obs"></td>
</tr>
</tbody>
</table>

<div class="actions">
<button onclick="enviarChecklist()">Enviar</button>
</div>

</div>

<script>
// ================= CONFIG =================
const API_URL  = "https://script.google.com/macros/s/AKfycbzTPPQtmgmuN0RoLqg0iQXXOs6eYPW1pVgujKsEPtAzMdbjsVNTorl2UQb-99IZSf0F8A/exec";
const BASE_URL = "https://noobsaibotmk2.github.io/migration-herospark/";

// ================= CONTROLE =================
const params = new URLSearchParams(window.location.search);
const checklistId = params.get("id");

if (checklistId) {
    document.getElementById("admin").classList.add("hidden");
    document.getElementById("clienteView").classList.remove("hidden");
}

// ================= ADMIN =================
function criarChecklist() {
    const cliente = document.getElementById("cliente").value;
    const responsavel = document.getElementById("responsavel").value;

    if (!cliente || !responsavel) {
        alert("Preencha todos os campos.");
        return;
    }

    const id = Date.now();
    const link = BASE_URL + "?id=" + id;

    fetch(`${API_URL}?action=criar&cliente=${encodeURIComponent(cliente)}&responsavel=${encodeURIComponent(responsavel)}&link=${encodeURIComponent(link)}`)
      .then(() => {
          alert("Checklist criado!\n\nEnvie este link ao cliente:\n" + link);
      });
}

// ================= CLIENTE =================
function enviarChecklist() {
    const linhas = document.querySelectorAll("#checklistTable tr");
    const dados = [];

    linhas.forEach(linha => {
        dados.push({
            tipo: linha.querySelector(".tipo").value,
            nome: linha.querySelector(".nome").value,
            segmento: linha.querySelector(".segmento").value,
            oferta: linha.querySelector(".oferta").value,
            assinatura: linha.querySelector(".assinatura").value,
            drive: linha.querySelector(".drive").value,
            observacoes: linha.querySelector(".obs").value
        });
    });

    fetch(`${API_URL}?action=enviar&id=${checklistId}&dados=${encodeURIComponent(JSON.stringify(dados))}`)
      .then(() => {
          alert("Checklist enviado com sucesso!");
      });
}

</script>

</body>
</html>


